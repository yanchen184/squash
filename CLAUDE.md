# 計分賽程競技系統 - 產品需求文檔

## 📋 專案概述

**專案名稱**：計分賽程競技系統  
**目標**：為 4 人固定順序賽制提供完整的賽事管理平台  
**技術棧**：React 18 + Firebase Realtime Database  
**版本**：v1.2.0+（新增玩家名字和歷史記錄功能）

---

## 🎯 核心功能現況

### 已實現功能
- **固定順序賽制**：AB → CD → CA → BD → BC → AD（6場循環）
- **位置輪動系統**：第二輪開始，玩家位置按 A→B→C→D→A 規則輪動
- **即時數據同步**：Firebase 即時數據庫同步，多設備協同
- **房間管理**：6位房間代碼，24小時有效期
- **即時積分統計**：實時更新積分排行榜
- **TBC 顯示邏輯**：動態對戰者確認機制
- **響應式設計**：支持桌面和移動端設備

### 當前限制
- 玩家標識使用 A/B/C/D 標籤，缺乏個人化
- 比賽結束後無法查看歷史戰績
- 無法追蹤長期表現和統計數據

---

## 🚀 新功能需求

### 需求 1：玩家名字替換標籤系統
**優先級**：🔴 高  
**目標**：將 A/B/C/D 標籤替換為真實玩家名字，提升個人化體驗

#### 功能描述
- 房間創建時要求輸入 4 位玩家名字
- 所有 UI 界面顯示玩家名字而非字母標籤
- 保持底層 A/B/C/D 邏輯不變，確保現有功能正常運作
- 在位置輪動系統中，名字正確跟隨位置變化

#### 技術實現方案
```javascript
// 建議的數據結構
const playerMapping = {
  A: { id: 'A', name: '張三', originalPosition: 'A' },
  B: { id: 'B', name: '李四', originalPosition: 'B' },
  C: { id: 'C', name: '王五', originalPosition: 'C' },
  D: { id: 'D', name: '趙六', originalPosition: 'D' }
};
```

#### 用戶體驗要求
- 名字長度限制：2-8 個中文字符或 4-12 個英文字符
- 提供預設名字選項（玩家1、玩家2等）
- 在所有對戰界面確保名字清晰可讀
- 支持名字重複但添加位置標識符以區分

#### 影響範圍
- `GameRoom.js`：玩家設定界面
- `GameBoard.js`：對戰顯示
- `MatchSchedule.js`：賽程表顯示
- `Leaderboard.js`：排行榜顯示
- Firebase 數據結構擴展

---

### 需求 2：歷史記錄功能
**優先級**：🟡 中高  
**目標**：提供比賽歷史記錄的儲存和查看功能，增強用戶參與度

#### 功能描述
**Phase 1：基礎歷史記錄**
- 自動儲存每場比賽結果（對戰者、勝者、時間戳）
- 儲存每輪積分變化
- 比賽結束後顯示完整戰績總覽

**Phase 2：進階歷史功能**
- 個人對戰矩陣（A vs B 的歷史勝負記錄）
- 個人統計數據（總比賽數、勝率、最佳表現）
- 房間歷史記錄頁面

#### 技術實現方案
```javascript
// Firebase 數據結構擴展
const historySchema = {
  roomId: 'string',
  roomName: 'string',
  players: {
    A: { name: 'string', finalScore: 'number' },
    B: { name: 'string', finalScore: 'number' },
    C: { name: 'string', finalScore: 'number' },
    D: { name: 'string', finalScore: 'number' }
  },
  matches: [
    {
      round: 'number',
      matchNumber: 'number',
      player1: { id: 'string', name: 'string' },
      player2: { id: 'string', name: 'string' },
      winner: { id: 'string', name: 'string' },
      timestamp: 'timestamp'
    }
  ],
  gameEndTime: 'timestamp',
  totalRounds: 'number'
};
```

#### 用戶界面設計
- **歷史總覽頁**：顯示最終積分排行和基本統計
- **詳細戰績頁**：按輪次展示每場比賽結果
- **個人統計頁**：顯示個人勝率和對戰記錄
- **快速存取**：比賽結束後一鍵查看歷史

#### 數據管理策略
- 歷史記錄保存 30 天後自動清理（成本控制）
- 重要統計數據永久保存
- 支援歷史數據匯出（JSON 格式）

---

## 🔧 技術實現計畫

### 開發階段規劃

**Stage 1：玩家名字功能（Week 1-2）**
1. 修改房間創建流程，添加玩家名字輸入
2. 更新所有顯示組件，替換 A/B/C/D 為玩家名字
3. 確保位置輪動邏輯正確處理名字顯示
4. 進行全面測試，確保向後兼容

**Stage 2：歷史記錄基礎功能（Week 3-4）**
1. 擴展 Firebase 數據結構
2. 實現比賽過程中的歷史數據收集
3. 創建歷史記錄查看組件
4. 添加比賽結束後的歷史總覽

**Stage 3：歷史記錄進階功能（Week 5-6）**
1. 實現個人統計和對戰矩陣
2. 添加歷史數據管理（清理、匯出）
3. 優化用戶界面和用戶體驗
4. 完整測試和性能優化

### 檔案結構變更
```
src/
├── components/
│   ├── History/              # 新增：歷史記錄組件
│   │   ├── HistoryOverview.js
│   │   ├── MatchDetails.js
│   │   └── PlayerStats.js
│   ├── GameRoom.js           # 修改：添加玩家名字設定
│   ├── GameBoard.js          # 修改：顯示玩家名字
│   ├── MatchSchedule.js      # 修改：顯示玩家名字
│   └── Leaderboard.js        # 修改：顯示玩家名字
├── services/
│   ├── historyService.js     # 新增：歷史記錄服務
│   └── database.js           # 修改：擴展數據操作
└── utils/
    └── gameLogic.js          # 修改：支持玩家名字邏輯
```

---

## 📊 成功指標與測試

### 關鍵績效指標（KPI）
- **功能使用率**：80% 的房間使用自定義玩家名字
- **歷史查看率**：60% 的完成比賽會查看歷史記錄
- **用戶滿意度**：透過功能使用頻率評估
- **系統穩定性**：新功能不影響現有功能表現

### 測試場景
**玩家名字功能測試：**
- 創建房間時輸入各種長度和字符的名字
- 驗證輪動系統中名字顯示正確性
- 測試重複名字的處理機制
- 確保響應式設計在不同螢幕尺寸下正常

**歷史記錄功能測試：**
- 完整比賽流程的數據記錄準確性
- 多輪比賽的歷史數據累積
- 歷史查看界面的用戶體驗
- Firebase 數據一致性和性能測試

---

## 🎮 用戶體驗考量

### 設計原則
- **簡潔性**：保持現有界面的簡潔風格
- **一致性**：新功能與現有設計語言統一
- **直觀性**：功能操作符合用戶直覺
- **性能**：新功能不影響系統反應速度

### 用戶引導
- 首次使用時提供玩家名字設定引導
- 歷史記錄功能的使用說明和入口提示
- 保持學習成本最低，避免複雜操作

---

## 🔮 未來擴展規劃

### 短期規劃（v1.3.0）
- 優化歷史記錄界面設計
- 添加數據匯出功能
- 實現跨房間個人統計

### 中期規劃（v1.4.0）
- 用戶註冊系統
- 全平台個人歷史追蹤
- 社群功能和分享機制

### 長期規劃（v2.0.0）
- 錦標賽模式
- 進階數據分析和視覺化
- 多平台同步和備份

---

## 📝 備註

**開發優先順序**：
1. 🔴 玩家名字替換功能（影響核心用戶體驗）
2. 🟡 基礎歷史記錄功能（增加產品價值）
3. 🟢 進階歷史統計功能（提升用戶黏性）

**風險管控**：
- 保持向後相容性，確保現有房間正常運作
- Firebase 成本控制，實施合理的數據清理策略
- 漸進式部署，避免影響線上服務穩定性

**技術債務**：
- 考慮重構部分組件以提高代碼可維護性
- 添加適當的錯誤處理和用戶反饋機制
- 建立完整的測試覆蓋率

---

*文檔版本*：v1.0  
*最後更新*：2025-07-29  
*負責人*：產品開發團隊